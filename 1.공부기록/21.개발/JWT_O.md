# JWT

- JWT(Json Web Token)
- 구조
    - JWT는 Header, Payload, Signature로 구성. 각 요소는 .으로 구분
    - Header : 타입과 해시 알고리즘의 종류 포함
    - Payload : 서버에서 첨부한 사용자 권한 정보와 데이터
    - Signature : Header, Payload를 Base64 URL-safe Encode 한 이후 Header에 명시된 해시함수를 적용하고, 개인키로 서명한 전자서명이 담겨있다.
- Payload에 민감한 정보를 넣으면 안된다
    - header와 payload는 누구든 디코딩 가능
- Signature
    - HMACSHA512(base64(header)+"."+base64(payload),서버개인키)
    - 서버의 개인키로만 복호화 가능
- 수평으로 쉽게 확장 가능
    - 세션방식의 인증의 경우 중앙 세션 스토리지 시스템이 필요
    - 고정 세션 방식은 비용이 증대됨
- 유지 보수 및 디버그 용이
    - Base64 방식으로 데이터 인코딩되어 웹 토큰 자체에 포함됨
- 보안성
    - 암호화 알고리즘으로 암호화하여 클라이언트 변조를 막음
    - 특정 IP 주소로 JWT발행 및 브라우저 핑거 프린팅 등을 사용하여 토큰 탈취에 따른 보안 강화
- RESTful 서비스에 적합
    - 쿠키방식의 경우 쿠키의 출처가된 도메인에 대해서만 사용할 수 있는 단점 해소
- 토큰 자체 만료시간 기술
    - 토큰 만료시간을 미리 알고 갱싱 요청을 할 수 있음
- Refresh Token
    - Access Token을 재발급 하는데 필요한 정보를 포함
    - 만료될 수 있으며 일반적으로 오랜기간 사용됨
    - 누출되지 않도록 엄격한 관리가 필요함
    - 발급된 IP 기준으로 제한을 두거나 브라우저 핑거프린터 정보등을 통해 유요성 확인 필요
- Access Token
    - 자원에 직접 Access하는데 필요한 정보를 포함
    - 클라이언트의 권한 부여 여부를 판단
    - 만료날짜가 있으며 토큰 수명이 짧음

## 인증과정
1. 서버에서 토큰을 생성하여 클라이언트로 전달
2. 클라이언트는 API 요청시 헤더에 토큰값 같이 전달
3. 서버는 해당 JWT토큰을 검증하여 인증인가처리
    - Signature를 개인키로 복호화하여 헤더와 페이로드가 위변조되었는지 확인