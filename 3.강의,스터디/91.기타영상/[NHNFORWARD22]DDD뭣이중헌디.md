# [NHN FORWARD 22] DDD 뭣이 중헌디?
출처 : https://www.youtube.com/watch?v=6w7SQ_1aJ0A

---
## DDD에 대한 오해
- DDD에서 전략적 설계가 중요하다
- 오해들
    - DDD는 은탄환이다.
    - DDD는 MSA로 귀결된다.
    - DDD는 방법론이다.
    - DDD는 기술이나 구현 영역이다.

## 도메인 주도 설계
- 방법론 X
- 접근법
- 전략적 설계

## 전략적 설계
- 비즈니스 도메인
    - 문제 도메인
        - 문제 공간 -> 해결 공간

### 도메인
- 비즈니스 도메인
    - 현실 세계 기업의 주요활동 영역
    - 회사가 고객에게 제공하는 서비스 영역
- 문제 도메인
    - 회사의 비즈니스 영역중 일부 영역을 소프트웨어로 해결하는 영역
    - 가치를 창출
    - 비즈니스 도메인과 문제 도메인이 같을 수 있다

### 문제 도메인 추출하기
- 현실세계
    - 티켓팅
- 소프트웨어 세계
    - 티켓팅 안의 인터넷 예매

### 문제 공간
- 인터넷 예매 -> 도메인 지식 소통 -> 하위 도메인(예매, 상품, 회원 등)
- 도메인 지식 소통
    - 최초 개발자는 도메인 지식이 전무하지만 도메인 전문가와 의사소통을 통해 해당도메인의 본질과 해결해야하는 문제를 파악
- 문제공간을 식별하는 일반적인 패턴
    - 비즈니스 도메인에서 소프트웨어로 해결할 수 있는 문제 도메인을 추출하고 이 것을 작은 하위 도메인으로 나누는 것

### Big Ball of Mud

### 전략적 설계 시 유용한 도구
- 사용 사례 use-case 분석
- 이벤트 스토밍 Event Storming
- Business Model 분석
- ...
- 지식탐구와 커뮤니케이션

## 전략적 설계 vs 전술적 설계
- 전략적 설계
    - 범위: 전반적
    - 목적: 문제 도메인을 해결영역으로
    - 메타포: 전쟁에서 전략
    - 주요 패턴: Bounded Context, Ubiquitous-Language
    - 수행 방식: 접근법
- 전술적 설계
    - 범위: 특정 Bounded Context
    - 목적: 풍부한 도메인 모델 적용
    - 메타포: 전투에서 전술
    - 주요 패턴: Aggregate, Domain-Event
    - 수행 방식: 상대적으로 방법론에 가까움

### 전략적 설계 과정
1. 비즈니스 도메인에서 문제 도메인 추출
2. 문제 도메인을 서브 도메인으로 나누기
3. 문제 공간 식별
4. 문제 공간을 해결 공간으로
- Bounded Context 간 경계를 설정하고 관계 설정

### Bounded-Context
- 경계가 있는 문맥
    - 바운디드 컨텍스트가 다르면 유비쿼터스 언어도 달라진다
- 모델 무결성(1)
    - 예매 바운디드 컨텍스트
        - 티켓
    - 고객 센터 바운디드 컨텍스트
        - 티켓
    - 회원 바운디드 컨텍스트
        - 어카운트
    - 은행 바운디드 컨텍스트
        - 어카운트

- 모델 무결성(2)
    - 예매 바운디드 컨텍스트
        - 프로덕트
            - 예매할 수 있는 상품인가?
            - 할인 가능한 상품인가?
    - 정산 바운디드 컨텍스트
        - 프로덕트
            - 상품 가격
            - 정산 대상인가?
    - 상품 바운디드 컨텍스트
        - 프로덕트
            - 상품 상세 정보
            - 상품 분류
            - 회차 정보
            - 예매자에게 노출하는 상품인가?
    - 스케줄 바운디드 컨텍스트
        - 프로덕트
            - 상품 상세 정보
            - 상품 분류
            - 회차 정보
            - 예매자에게 노출하는 상품인가?
    - 전략적 설계는 답이 없는 예술의 영역(상품 바운디드 컨텍스트와 스케줄 바운디드 컨텍스트는 합쳐질 수도 있다)

## 바운디드 컨텍스트와 하위 도메인
- 하위 도메인과 바운디드 컨텍스트는 일종의 집합관계 해결공간을 찾을 때 다양한 상황이 나온다. 해결공간을 표현할때 하나의 하위 도메인의 바운디드 컨텍스트가 보통은 한개 이상 존재할 수 있다. 이것이 하위 도메인과 바운디드 컨텍스트의 일반적인 관계
- 하위 도메인과 바운디드 컨텍스트가 일대일 일수도 있다.
- 상황에 따라서는 바운디드 컨텍스트가 여러개의 하위 도메인을 가지는 경우도 있다

## 콘웨이의 법칙
- 소프트웨어의 구조는 해당 소프트웨어를 개발하는 조직의 구조를 따라간다

## 역 콘웨이의 전략
- 개발하는 조직의 구조를 소프트웨어의 구조에 맞춘다

## Context-Map
- 바운디드 컨텍스트의 매핑관계를 그린 다이어그램

### 바운디드 컨텍스트 매핑 관계
- 부패 방지 계층(ACL)
    - 도메인 모델의 부패(손상)을 방지하는 계층
    - 외부 의존 모델을 번역해서 도메인 모델로
- 공유 커널(SC)
    - 두 컨텍스트가 공통의 Context를 공유해서 사용
    - 긴밀한 팀에서 적용 가능
- 오픈 호스트 서비스(OHS)
    - 공급자 컨텍스트에서 소비자 컨텍스트에 맞게 모델 제공
    - 일반적으로 공표된 언어(PL)로 제공
- 분리형 노선(SW)
    - 각각 모델을 관리
    - 중복 발생
- 파트너십(P)
    - 두 팀이 최대한 협력
    - 매우 긴밀한 팀에서 적용 가능, 공유 커널
- 고객/공급자(C/S)
    - 공급자는 고객의 요구에 가능한 들어줘야 한다
    - 갑: 소비자 컨텍스트, 을: 공급자 컨텍스트
- 순응자(Conformist)
    - 고객은 공급자(외부 솔루션, 레거시 등)가 주는 대로 사용해야한다
    - 갑: 공급자 컨테스트, 을: 소비자 컨텍스트
- 비동기 이벤트(Async)
    - 메시지 브로커를 통한 비동기 통합
    - 개발 난이도 상승, 결과적 일관성

## 진화하는 설계

## 정리
- DDD에서 전략적 설계가 중요하다
- 지식 탐구와 커뮤니케이션
- 언제 어디서나 유비쿼터스 언어