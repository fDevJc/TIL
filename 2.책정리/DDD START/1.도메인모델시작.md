# 도메인 모델 시작
## 👉 도메인
- 도메인이란 소프트웨어로 해결하고자하는 문제 영역. 
- 한 도메인은 다시 하위 도메인으로 나눌 수 있다.
- 하위 도메인을 어떻게 구성할지 여부는 상황에 따라 달라진다.

## 👉 도메인 모델
- 도메인 모델에는 다양한 정의가 존재하는데 기본적으로 도메인 모델은 특정 도메인을 개념적으로 표현한 것이다.
- 도메인을 이해하는 데 도움이 된다면 표현 방식이 무엇인지는 중요하지 않다.
- 도메인 모델은 기본적으로 도메인 자체를 이해하기 위한 개념 모델이다.

## 👉 도메인 모델 패턴
- 일반적인 애플리케이션의 아키텍처는 네 개의 계층으로 구성된다.
    - 사용자 인터페이스(UI) 또는 표현(Presentation)
        - 사용자의 요청을 처리하고 사용자에게 정보를 보여준다. 여기서 사용자는 실제 사람뿐만 아니라 외부 시스템도 해당된다.
    - 응용(Application)
        - 사용자가 요청한 기능을 실행한다. 업무 로직을 직접 구현하지 않으며 도메인계층을 조합해서 기능을 실행
    - 도메인
        - 시스템이 제공할 도메인의 규칙을 구현한다.
    - 인프라스트럭처(Infrastructure)
        - 데이터베이스나 메시징 시스템과 같은 오비ㅜ 시스템과의 연동을 처리한다.

## 👉 마틴 파울러의 도메인 모델 패턴
- 도메인 계층은 도메인의 핵심 규칠을 구현한다.
- 도메인 규칙을 객체 지향 기법으로 구현하는 패턴이 도메인 모델 패턴이다.
- 중요 업뮤 규칙을 도메인 모델에 구현
- 핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 규칙이 바뀌거나 규칙을 확장해야 할 때 다른 코드에 영향을 덜 주고 변경 내역을 모델에 반영할 수 있게 된다.

## 👉 도메인 모델 도출
- 도메인을 모델링할 때 기본이 되는 작업은 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것이다. 이 과정은 요구사항에서 출발한다.
- 모델을 공유할 때는 화이트보드나 위키와 같은 도구를 사용해서 누구나 쉽게 접근할 수 있도록 하면 좋다.
>문서화를 하는 주된 이유는 지식을 공유하기 위함

## 👉 엔티티와 밸류
### 엔티티
- 엔티티의 가장큰 특징은 식별자를 갖는다는 것이다.
- 엔티티의 식별자는 바뀌지 않는다.
- 두 엔티티 객체의 식별자가 같으면 두 엔티티는 같다고 표현할 수 있다. (equals(), hashCode() 메서드 구현)

### 엔티티의 식별자 생성
- 특정 규칙에 따라 생성
- UUID 사용
- 값을 직접 입력
- 일련번호 사용(시퀀스나 DB의 자동 증가 칼럼 사용)
>자동증가 칼럼을 제외한 다른 방식은 식별자를 먼저 생성하고 엔티티에 식별자를 전달할 수 있다. 하지만 자동증가 칼럼 방식의 경우 DB에 데이터를 삽입해야 비로소 값을 알 수 있다.

### 밸류
- 밸류 타입은 개념적으로 완전한 하나를 표현할 때 사용한다. (ex: Address 주소, 우편번호 등을 포함)
- 의미를 명확하게 표현하기 위해 밸류 타입을 사용하는 경우도 있다.
- 밸류 타입의 장점은 밸류타입을 위한 기능을 추가할 수 있다는 것이다.
> 데이터 변경 기능을 제공하지 않는 타입을 불변이라고 표현
- 밸류 타입을 불변으로 구현하는 이유는 여러 가지가 있는데 가장 중요한 이유는 불변 타입을 사용하면 보다 안전한 코드를 작성할 수 있다는 것이다.
- 불변 객체는 참조 투명성과 스레드에 안전한 특징을 갖고 있다.
🤔 참조 투명성?
- 밸류 타입의 객체 비교는 몯느 속성이 같은지 비교해야한다.

### 엔티티 식별자와 밸류 타입
- 식별자를 밸류타입으로 만들어 의미가 잘 드러나도록 할 수 있다.

### 도메인 모델에 set메서드 넣지 않기
- set메서드를 이용하면 단순히 상태 값만 변경할지 아니면 상태 값에 따라 다른 처리를 위한 코드를 함께 구현할지 애매하다. 습관적으로 코드를 작성하는 경우라면 필드 값만 변경하고 끝나는 경우가 많기 때문에 상태변경과 관련된 도메인 지식이 코드에서 사라지게 된다.
- 도메인 객체를 생성할 때 완전한 상태가 아닐수도 있다.
- 도메인 객체가 불완전한 상태로 사용되는 것을 막으려면 생성 시점에 필요한 것을 전달해 주어야 한다. 즉, 생성자를 통해 필요한 데이터를 모두 받아야 한다. 생성자로 필요한 것을 모두 받으므로 생성자를 호출하는 시점에 필요한 데이터가 올바른지 확인할 수 있다.
- set메서드를 구현해야 할 특별한 이유가 없다면 불변 타입의 장점을 살릴 수 있도록 밸류 타입은 불변으로 구현한다.

## 도메인 용어
- 도메인에서 사용하는 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야하는 부담을 준다.
- 도메인 용어를 사용하면 코드의 가독성을 높이게 되고, 도메인 용어를 사용해서 최대한 도메인 규칙을 코드로 작성하게 되므로 버그도 줄어들게 된다.