- ecosystem 1 - kafka client
    - kafkaì™€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” java lib
    - Producer, Consumer, Admin, Stream ë“± kafka ê´€ë ¨ api ì œê³µ
    - ë‹¤ì–‘í•œ 3rd party libì¡´ì¬
    - ëª…ë ¹ì–´
        - kafka ì„œë²„ ê¸°ë™
            - /Users/jicheol/study-inflearn/microservice/kafka_2.13-3.2.0
            - zookeeper ë° kafka ì„œë²„ êµ¬ë™
            - ./bin/zookeeper-server-start.sh ./config/zookeeper.properties
            - ./bin/kafka-server-start.sh ./config/server.properties
        - topic ìƒì„±
            - ./bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic í† í”½ì´ë¦„ --partitions 1
        - topic ëª©ë¡ í™•ì¸
            - ./bin/kafka-topics.sh --bootstrap-server [localhost:9092](http://localhost:9092) --list
        - topic ì •ë³´ í™•ì¸
            - ./bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe --topic quickstart-events
        - producer
            - ./bin/kafka-console-producer.sh --broker-list localhost:9092 --topic quickstart-events
        - consumer
            - ./bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic quickstart-events --from-beginning

---

- ecosystem 2 - kafka connect
    - kafka connectë¥¼ í†µí•´ dataë¥¼ import/export ê°€ëŠ¥
    - ì½”ë“œ ì—†ì´ configurationìœ¼ë¡œ ë°ì´í„°ë¥¼ ì´ë™
    - standalone mode, Distribution mode ì§€ì›
        - RESTful API í†µí•´ ì§€ì›
        - stream ë˜ëŠ” Batch í˜•íƒœë¡œ ë°ì´í„° ì „ì†¡ ê°€ëŠ¥
        - ì»¤ìŠ¤í…€ Connectorë¥¼ í†µí•œ ë‹¤ì–‘í•œ Plugin ì œê³µ (File, S3, Hive, Mysql, etc â€¦)
    - source â†’ kafka connect source â†’ kafka cluster â†’ kafka connect sink â†’ target
    - ì„¸íŒ…
        
        ### **Kafka Connect ì„¤ì¹˜**
        
        curl -O http://packages.confluent.io/archive/5.5/confluent-community-5.5.2-2.12.tar.gz
        
        curl -O http://packages.confluent.io/archive/6.1/confluent-community-6.1.0.tar.gz
        
        tar xvf confluent-community-6.1.0.tar.gz
        
        cdÂ  $KAFKA_CONNECT_HOME
        
        ### **Kafka Connect ì‹¤í–‰**
        
        ./bin/connect-distributed ./etc/kafka/connect-distributed.properties
        
        ### **JDBC Connector ì„¤ì¹˜**
        
        - https://docs.confluent.io/5.5.1/connect/kafka-connect-jdbc/index.html
        - confluentinc-kafka-connect-jdbc-10.0.1.zip
        
        ### **etc/kafka/connect-distributed.properties íŒŒì¼ ë§ˆì§€ë§‰ì— ì•„ë˜ plugin ì •ë³´ ì¶”ê°€**
        
        - plugin.path=[confluentinc-kafka-connect-jdbc-10.0.1 í´ë”]
        
        ### **JdbcSourceConnectorì—ì„œ MariaDB ì‚¬ìš©í•˜ê¸° ìœ„í•´ mariadb ë“œë¼ì´ë²„ ë³µì‚¬**
        
        ./share/java/kafka/ í´ë”ì— mariadb-java-client-2.7.2.jarÂ  íŒŒì¼ ë³µì‚¬
        

---

- mariadb
    - ğŸ¤”Â mariadb vs mysql ????

---

- ë§ì”€í•˜ì‹  ë°©ë²•ìœ¼ë¡œ Producerì™€ Consumerë¥¼ ê°ê° êµ¬í˜„í•˜ì‹œê³ , DB ì—°ë™ ì‘ì—…ì„ í†µí•´ ë°ì´í„°ì˜ ì´ì „ì„ ì²˜ë¦¬í•˜ì…”ë„ ë©ë‹ˆë‹¤. Kafka Connectì˜ ëª©ì ì€ í”„ë¡œê·¸ë˜ë°ì„ í•˜ì§€ ì•Šê³ ë„, í•˜ë‚˜ì˜ Resourceì—ì„œ ë‹¤ë¥¸ Resourceë¡œ ë°ì´í„°ë¥¼ ì´ì „í•˜ëŠ” ëª©ì ì´ ìˆìŠµë‹ˆë‹¤. Kafka ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ Kafka Connectì˜ ì¥ë‹¨ì ê³¼ ì‚¬ìš© ëª©ì ì— ë”°ë¼ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. Kafka Connectì˜ Connectorë¥¼ ì¬ì •ì˜í•´ì„œ ì‚¬ìš©í•˜ì‹œë©´, ì½”ë“œì˜ ì–‘ì„ ì¤„ì´ë©´ì„œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì— ì¢…ì†ì ì´ì§€ ì•Šì€ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. [http://kafka.apache.org/documentation/#connect](http://kafka.apache.org/documentation/#connect) 
Kafka Connectì´ì™¸ì—ë„ Kafka Stream(http://kafka.apache.org/documentation/streams/)ë‚˜ ksqlDB(https://www.confluent.io/product/ksql/)ë¥¼ í†µí•´ ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë¥¼ ë¹ ë¥¸ ì†ë„ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ìŠ¤íŠ¸ë§ í•´ì£¼ëŠ” ì„œë¹„ìŠ¤ë“¤ë„ ìˆìœ¼ë‹ˆ ê´€ì‹¬ìˆìœ¼ì‹œë©´ ê°™ì€ ì‚´í´ ë³´ì‹œëŠ”ê²ƒë„ ì¶”ì²œ ë“œë¦½ë‹ˆë‹¤.
ê°ì‚¬í•©ë‹ˆë‹¤.

---

- CatalogService
    - spring-kafka dependency ì¶”ê°€
    - Consumer configure ë¹ˆ ì¶”ê°€
        
        ```java
        @EnableKafka
        @Configuration
        public class KafkaConsumerConfig {
        		@Bean
        		public ConsumerFactory<String, String> consumerFactory() {}
        
        		@Bean
        		public ConcurrentKafkaListenerContainerFactory<String, String> kafkaListenerContainerFactory() {}
        }
        ```
        
    - Consumer service ì¶”ê°€
        
        ```java
        @KafkaListener(topics = "example-catalog-topic")
        public void updateQty(String kafkaMessage) {}
        ```
        
- OrderService
    - spring-kafka dependency ì¶”ê°€
    - Producer configure ë¹ˆ ì¶”ê°€
        
        ```java
        @EnableKafka
        @Configuration
        public class KafkaProducerConfig {
            @Bean
            public ProducerFactory<String, String> producerFactory() {}
        		@Bean
            public KafkaTemplate<String, String> kafkaTemplate() {}
        ```
        
    - KafkaTemplateë¥¼ ì´ìš©í•´ send
        
        ```java
        kafkaTemplate.send(topic, jsonInString);
        ```
        
- ë³µìˆ˜ì˜ ì„œë¹„ìŠ¤ â†’ kafka â†’ í•˜ë‚˜ì˜ ë””ë¹„
- ë³µìˆ˜ì˜ ì„œë¹„ìŠ¤ â†’ ì—¬ëŸ¬ê°œì˜ ë””ë¹„ (kafka í†µí•œ ë™ê¸°í™”)

---

- ğŸ¤” CQRS íŒ¨í„´
