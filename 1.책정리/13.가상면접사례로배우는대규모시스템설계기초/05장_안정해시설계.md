# 안정 해시 설계
- N개의 캐시 서버에 부하를 균등하게 나누는 보편적방법은 해시함수를 이용하는 것
    - serverIndex = hash(key) % N(서버의 개수)
    - 해당 방법은 서버풀의 크기가 고정되어 있을때, 데이터 분포가 균등할 때는 잘동작
    - 하지만 서버가 죽거나 서버를 추가할때 문제가 발생
- 안정 해시
    - 해시함수를 SHA-1로 가정
        - SHA-1의 해시공간의 범위는 0 ~ 2^160 - 1
    - 해당 범위를 시작점과 끝점을 이어 원으로 만든다
    - 서버를 원의 어떤 위치에 배치
    - 캐시할 키 또한 원 위의 어느 지점
    - 키가 저장되는 위치는 시계방향으로 가장 가까운 서버
    - 서버를 추가 할경우 적은 수의 키만 재배치
    - 서버의 삭제 역시 적은 수의 키만 재배치
    - 단점
        - 파티션의 크기가 균등히 유지가 안됨
        - 균등분포를 달성하기 어려움
- 위의 단점을 해결하는 가상노드 또는 복제라 불리는 기법
    - 원의 각각의 서버는 N개의 노드를 갖는다
    - 키는 시계방향으로 가장 가까운 노드의 서버에 저장
    - 안정 해시의 각각의 서버에 노드를 추가한 개념으로 노드의 수를 적절히 분배하면 안정해시의 단점을 줄일 수 있다