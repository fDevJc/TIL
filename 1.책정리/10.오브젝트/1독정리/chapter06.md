## Chapter06 메시지와 인터페이스
- 클래스는 객체지향을 위한 `도구`
- `협력`안에서 객체가 수행하는 `책임`에 초점
- `책임`이 객체가 수신할 수 있는 `메시지`의 기반
- 객체지향 애플리케이션에서 가장 중요한 재료는 클래스가 아니라 객체들이 주고받는 `메시지`
- 객체가 수신하는 `메시지`들이 객체의 `퍼블릭 인터페이스`를 구성한다
- 클라이언트 서버 모델
    - 객체가 다른 객체에 접근할 수 있는 유일한 수단은 `메시지`
    - 메시지를 전송하는 객체를 클라이언트, 메시지를 수신하고 응답하는 객체를 서버
    - 객체가 독립적으로 수행하는 것보다 더 큰 책임을 수행하기 위해서는 다른객체와 협력해야한다
- 메시지는 오퍼레이션명, 인자로 구성되며 메시지 전송은 여기에 수신자를 추가
    - condition.isSatisfiedBy(screening)
    - 수신자.오퍼레이션명(인자)
- 메시지를 수신했을 때 실제로 어떤 코드가 실행되는지는 수신자의 실제 타입이 무엇인가에 달려있다
- 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저를 `메서드`라고 부른다
- 전통적인 개발은 어떤 코드가 실행될지를 알고 함수, 프로시저를 호출
- 반면 객체는 메시지와 메서드라는 다른 개념을 `실행 시점`에 연결하기 때문에 컴파일 시점과 실행 시점 의미가 달라질 수 있다
- 메시지와 메서드의 구분은 전송자와 수신자를 느슨하게 결합 시킨다
- 메시지 전송자는 수신자가 어떤 클래스의 인스턴스인지, 어떤방식으로 요청을 처리하는지 모르더라도 메시지 전송을 할 수 있으며 수신자는 메시지를 처리하기 위해 필요한 메서드를 스스로 결정할 수 있는 자율권을 누린다
- 오퍼레이션은 구현이 아닌 추상화, 메서드는 오퍼레이션을 구현한 것
- 오퍼레이션(또는 메서드)의 이름과 파라미터 목록을 합쳐 `시그니처`라고 부른다
- 하나의 오퍼레이션에 하나의 메서드만 존재할 경우 오퍼레이션과 메서드를 구분할 필요는 없다. 하지만 다형성을 위해서는 하나의 오퍼레이션에 여러 메서드를 구현해야한다
- 좋은 인터페이스는 최소한의 인터페이스와 추상적인 인터페이스
    - 꼭필요한 오퍼레이션만, 인터페이스는 어떻게 수행되는지가 아니라 무엇을 하는지를 표현
- 디미터 법칙
    - 객체의 내부 구조에 강하게 결합되지 않도록 협력 경로를 제한
    - 클래스가 특정한 조건을 만족하는 대상에게만 메시지를 전송하도록 프로그래밍
    - this 객체, 메서드의 매개변수, this의 속성, this의 속성인 컬렉션의 요소, 메서드내 지역 객체에게만 메시지를 전송
    - 디미터의 법칙을 무시하는 대표적 코드
        - screening.getMovie().getDiscountConditions();
        - 이러한 코드를 기차충돌 이라 한다
        - 메시지 전송자는 메시지 수신자의 내부 정보를 자세히 알게됨 -> 강결합
    - `무비판적으로 디미터의 법칙을 수용할 경우 객체의 응집도가 낮아질 수도 있다`
    - `객체의 내부 구조를 묻는 메시지가 아니라 수신자에게 무언가를 시키는 메시지가 좋다`
- 묻지 말고 시켜라
    - 객체 외부에서 해당 객체의 `상태`를 기반으로 결정을 내리는 것은 객체의 캡슐화를 위반
    - 객체지향의 기본은 `함께 변경될 확률이 높은 정보와 행동을 하나의 단위로 묶는 것`
    - 내부의 상태를 묻는 오퍼레이션을 인터페이스로 가지고 있다면 좀더 나은 방법이 없는지 고민해보라
    - 상태를 묻는 오퍼레이션을 `행동을 요청하는 오퍼레이션`으로 대체
    - 인터페이스는 객체가 어떻게하는지가 아니라 `무엇을 하는지`를 노출
- 의도를 드러내는 인터페이스
    - 책임을 수행하는 방법을 드러내는 메서드를 사용한 설계는 변경에 취약
    - 매우 다른 두번째 구현을 상상하고 해당 메서드에 동일한 이름을 붙인다고 상상해보라, 추상적인 이름을 지을 수 있게 된다
- 근본적으로 디미터 법칙을 위반하는 설계는 인터페이스와 구현의 분리원칙을 위반
- 오퍼레이션은 `클라이언트`가 객체에게 `무엇을 원하는지`를 표현해야한다
- 디미터의 법칙, 묻지말고 시켜라 스타일은 객체의 퍼블릭 인터페이스를 깔끔하고 유연하게 만들어주는 훌륭한 설계 원칙
    - 법칙에는 예외가 없지만 원칙에는 예외가 넘쳐난다
    - 설계는 트레이드오프의 산물
    - 원칙이 현재 상황에 부적합하다고 판단된다면 과감하게 원칙을 무시하라
    - 원칙을 아는 것보다 적절하게 선택하는 판단이 중요
    - 디미터의 법칙은 하나의 도트를 강요하는 것이 아니다
        - IntStream.of(1,2).filter(x -> x > 1).distinct().count();
        - 위의 코드에는 내부 구조가 외부로 노출된것이 아니다
        - 위의 코드는 내부에 대한 어떤 내용도 묻지않는다 수행하라고 시킬 뿐이다
        - 디미터 법칙은 결합도와 관련된 것이며, 결합도가 문제가 되는것은 내부 구조가 외부로 노출되는 경우
- 명령 쿼리 분리 원칙
    - 객체의 상태를 수정하는 오퍼레이션을 명령
    - 객체와 관련된 정보를 반환하는 오퍼레이션을 쿼리
    - 명령과 쿼리를 분리하면 객체의 부수효과를 제어하기가 수월
- 어떤 값이 불변하다는 말은 부수효과가 발생하지 않는다는 말과 동일
- 참조 투명성
    - 함수형 프로그래밍
    - 수학

## 정리
- 메시지
    - 객체가 다른 객체에 접근할 수 있는 유일한 수단
    - 메시지가 수신자의 퍼블릭 인터페이스가 된다
- 오퍼레이션
- 메서드
    - 수신자가 실제로 메시지를 수신했을때 실행되는 함수 또는 프로시저
    - 메시지와 메서드의 구분은 실행시점에 어떤 메서드가 실행될지를 결정하기에 전송자와 수신자의 결합을 느슨하게 해준다
- 퍼블릭 인터페이스
- 시그니처
- 디미터의 법칙
    - 메시지를 먼저 고려하고 수신자의 내부구현을 모른다면 디미터의 법칙을 준수할 확률이 높아진다
- 묻지 말고 시켜라
    - 메시지를 먼저 고려할 경우 정보를 묻는 것이 아니라 행동을 요청하게 된다
- 의도를 드러내는 인터페이스
    - 메시지를 먼저 고려할 경우 클라이언트가 원하는 의도가 드러날 수 있다
- 명령-쿼리 분리 원칙